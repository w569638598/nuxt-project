import e from"node:process";globalThis._importMeta_=globalThis._importMeta_||{url:"file:///_entry.js",env:e.env};import{getRequestDependencies as t,getPreloadLinks as n,getPrefetchLinks as r,createRenderer as s}from"vue-bundle-renderer/runtime";import{u as o,e as a,s as i,a as d,g as l,b as u,c,d as p,j as f,f as h,h as m,i as y,k as b}from"../runtime.mjs";import{stringify as A,uneval as g}from"devalue";import{renderToString as _}from"vue/server-renderer";import{propsToString as v,renderSSRHead as w}from"@unhead/ssr";import{createServerHead as R,CapoPlugin as x}from"unhead";import{version as C,unref as S}from"vue";import{defineHeadPlugin as T}from"@unhead/shared";const j="3"===C[0];function resolveUnrefHeadInput(e){if(e instanceof Promise||e instanceof Date||e instanceof RegExp)return e;const t="function"==typeof(n=e)?n():S(n);var n;if(!e||!t)return t;if(Array.isArray(t))return t.map((e=>resolveUnrefHeadInput(e)));if("object"==typeof t){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&("titleTemplate"===n||"o"===n[0]&&"n"===n[1]?e[n]=S(t[n]):e[n]=resolveUnrefHeadInput(t[n]));return e}return t}const U=T({hooks:{"entries:resolve":e=>{for(const t of e.entries)t.resolvedInput=resolveUnrefHeadInput(t.input)}}});function createServerHead(e={}){const t=R(e);return t.use(U),t.install=function(e){return{install(t){j&&(t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide("usehead",e))}}.install}(t),t}const L=[x({track:!0})],k={omitLineBreaks:!1},P={meta:[{name:"viewport",content:"width=device-width, initial-scale=1"},{charset:"utf-8"},{name:"keywords",content:"影划算电影票,影划算票务,电影票接口,电影票API,电影票SaaS系统,电影票小程序,特价影票,5折电影票,特惠电影票,电影票学生价,电影票订购平台"},{name:"description",content:"影划算电影票提供全国电影院在线购票服务系统搭建，独立研发特价电影票优惠购票SaaS系统，支持微信/支付宝小程序系统搭建，自主品牌OEM、多种营销模式、分销系统实时结算，并提供开放平台API接口技术对接。"}],link:[],style:[],script:[],noscript:[],title:"影划算官网 - 特惠电影票服务商，提供一站式电影票营销解决方案。"},H={id:"teleports"};function baseURL(){return o().app.baseURL}function buildAssetsURL(...e){return f(publicAssetsURL(),o().app.buildAssetsDir,...e)}function publicAssetsURL(...e){const t=o().app,n=t.cdnURL||t.baseURL;return e.length?f(n,...e):n}globalThis.__buildAssetsURL=buildAssetsURL,globalThis.__publicAssetsURL=publicAssetsURL;const getClientManifest=()=>import("../build/client.manifest.mjs").then((e=>e.default||e)).then((e=>"function"==typeof e?e():e)),$=lazyCachedFunction((()=>import("../build/styles.mjs").then((e=>e.default||e)))),I=lazyCachedFunction((async()=>{const e=await getClientManifest();if(!e)throw new Error("client.manifest is not available");const t=await import("../build/server.mjs").then((e=>e.default||e));if(!t)throw new Error("Server bundle is not available");return s(t,{manifest:e,renderToString:async function(e,t){const n=await _(e,t);return E+n+B},buildAssetsURL:buildAssetsURL})})),M=lazyCachedFunction((async()=>{const e=await getClientManifest(),t=await import("../virtual/_virtual_spa-template.mjs").then((e=>e.template)).catch((()=>"")).then((e=>E+e+B)),n=s((()=>()=>{}),{manifest:e,renderToString:()=>t,buildAssetsURL:buildAssetsURL}),r=await n.renderToString({});return{rendererContext:n.rendererContext,renderToString:e=>{const t=o(e.event);return e.modules=e.modules||new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(r)}}})),O=!!H.id,N=O?`<div${v(H)}>`:"",z=O?"</div>":"",E=`<div${v({id:"__nuxt"})}>`,B="</div>",D=/\/_payload.json(\?.*)?$/,F=function(e){const t=o();return a((async n=>{if(n.path===`${t.app.baseURL}favicon.ico`)return i(n,"Content-Type","image/x-icon"),d(n,"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");const r=await e(n);if(!r){const e=l(n);return u(n,200===e?500:e),d(n,"No response returned from render handler: "+n.path)}const s=p();return await s.hooks.callHook("render:response",r,{event:n}),r.headers&&c(n,r.headers),(r.statusCode||r.statusMessage)&&u(n,r.statusCode,r.statusMessage),r.body}))}((async e=>{const s=p(),a=e.path.startsWith("/__nuxt_error")?h(e):null;if(a&&a.statusCode&&(a.statusCode=Number.parseInt(a.statusCode)),a&&!("__unenv__"in e.node.req))throw m({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const i=false,d=void 0;let u=a?.url||e.path;const c=D.test(u)&&!0;c&&(u=u.substring(0,u.lastIndexOf("/"))||"/",e._path=u,e.node.req.url=u);const f=y(e),g=createServerHead({plugins:L}),_={mode:"server"};g.push(P,_);const v={url:u,event:e,runtimeConfig:o(e),noSSR:e.context.nuxt?.noSSR||!1===f.ssr&&!0||!1,head:g,error:!!a,nuxt:void 0,payload:a?{error:a}:{},_payloadReducers:Object.create(null),modules:new Set,islandContext:d},R=v.noSSR?await M():await I();for(const e of await getClientManifest().then((e=>Object.values(e).filter((e=>e._globalCSS)).map((e=>e.src)))))v.modules.add(e);const x=await R.renderToString(v).catch((async e=>{if(v._renderResponse&&"skipping render"===e.message)return{};const t=!a&&v.payload?.error||e;throw await(v.nuxt?.hooks.callHook("app:error",t)),t}));if(await(v.nuxt?.hooks.callHook("app:rendered",{ssrContext:v,renderResult:x})),v._renderResponse)return v._renderResponse;if(v.payload?.error&&!a)throw v.payload.error;if(c){const e=function(e){return{body:A(splitPayload(e).payload,e._payloadReducers),statusCode:l(e.event),statusMessage:b(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(v);return e}const C=await async function(e){const t=await $(),n=new Set;for(const r of e)if(r in t)for(const e of await t[r]())n.add(e);return Array.from(n).map((e=>({innerHTML:e})))}(v.modules??[]),S=f.experimentalNoScripts,{styles:T,scripts:j}=t(v,R.rendererContext);C.length&&g.push({style:C});{const e=[];for(const t in T){const n=T[t];e.push({rel:"stylesheet",href:R.rendererContext.buildAssetsURL(n.file)})}e.length&&g.push({link:e},_)}S||(g.push({link:n(v,R.rendererContext)},_),g.push({link:r(v,R.rendererContext)},_),g.push({script:renderPayloadJsonScript({ssrContext:v,data:v.payload})},{..._,tagPosition:"bodyClose",tagPriority:"high"})),f.experimentalNoScripts||g.push({script:Object.values(j).map((e=>({type:e.module?"module":null,src:R.rendererContext.buildAssetsURL(e.file),defer:!e.module||null,tagPosition:"head",crossorigin:""})))},_);const{headTags:U,bodyTags:E,bodyTagsOpen:B,htmlAttrs:F,bodyAttrs:X}=await w(g,k),q={island:i,htmlAttrs:F?[F]:[],head:normalizeChunks([U]),bodyAttrs:X?[X]:[],bodyPrepend:normalizeChunks([B,v.teleports?.body]),body:[x.html,N+(O?joinTags([v.teleports?.[`#${H.id}`]]):"")+z],bodyAppend:[E]};await s.hooks.callHook("render:html",q,{event:e});var J;return{body:(J=q,`<!DOCTYPE html><html${joinAttrs(J.htmlAttrs)}><head>${joinTags(J.head)}</head><body${joinAttrs(J.bodyAttrs)}>${joinTags(J.bodyPrepend)}${joinTags(J.body)}${joinTags(J.bodyAppend)}</body></html>`),statusCode:l(e),statusMessage:b(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}}}));function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch((e=>{throw t=null,e}))),t)}function normalizeChunks(e){return e.filter(Boolean).map((e=>e.trim()))}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?A(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":"nuxt-app","data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${g(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:n,...r}=e.payload;return{initial:{...r,prerenderedAt:n},payload:{data:t,prerenderedAt:n}}}const X=Object.freeze({__proto__:null,default:F});export{buildAssetsURL as a,baseURL as b,X as r};
